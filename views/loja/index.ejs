<%- include('cabecalho.ejs') %>

<div class="row justify-content-center">
    <div class="col-12 text-center mb-5">
        <h1 class="display-4 fw-bold">Catálogo de Jogos</h1>
        <p class="lead text-light">Os melhores jogos selecionados para você.</p>
    </div>
</div>

<div class="row">
    <% if(jogos.length === 0) { %>
        <div class="col-12 text-center">
            <div class="alert alert-dark" role="alert">
                Nenhum jogo encontrado. <a href="/adm/jogo/add" class="alert-link">Acesse o Admin</a> para cadastrar.
            </div>
        </div>
    <% } %>

    <% for(const jogo of jogos) { %>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
            <div class="card game-card h-100">
                <!-- Imagem do jogo com fallback -->
                <% if(jogo.poster) { %>
                    <img src="<%= jogo.poster %>" class="card-img-top" alt="<%= jogo.nome %>">
                <% } else { %>
                    <div class="card-img-top d-flex align-items-center justify-content-center bg-secondary" style="height: 250px;">
                        <i class="bi bi-image fs-1 text-white-50"></i>
                    </div>
                <% } %>

                <div class="card-body">
                    <h5 class="card-title"><%= jogo.nome %></h5>
                    <p class="card-price">R$ <%= jogo.preco.toFixed(2).replace('.', ',') %></p>
                    
                    <!-- Botão Modal -->
                    <button type="button" class="btn btn-app-action mt-auto" data-bs-toggle="modal" data-bs-target="#modalJogo<%= jogo._id %>">
                        <i class="bi bi-eye-fill"></i> Ver Detalhes
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Detalhes (Estilo App) -->
        <div class="modal fade" id="modalJogo<%= jogo._id %>" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title"><%= jogo.nome %></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <% if(jogo.poster) { %>
                            <img src="<%= jogo.poster %>" class="img-fluid rounded mb-3" style="max-height: 300px;" alt="<%= jogo.nome %>">
                        <% } %>
                        
                        <div class="text-start px-3">
                            <p><%= jogo.descricao %></p>
                            
                            <div class="mb-2">
                                <strong>Gêneros:</strong> 
                                <% jogo.generos.forEach(gen => { %>
                                    <span class="badge badge-genre rounded-pill"><%= gen %></span>
                                <% }) %>
                            </div>
                            <p class="mb-1"><small><i class="bi bi-building"></i> Dev: <%= jogo.desenvolvedora.nome %></small></p>
                            <p class="mb-1"><small><i class="bi bi-truck"></i> Dist: <%= jogo.distribuidora.nome %></small></p>
                            <p class="mb-1"><small><i class="bi bi-memory"></i> RAM: <%= jogo.minRam %></small></p>
                            <p class="mb-3"><small><i class="bi bi-hdd"></i> Armz: <%= jogo.armazenamento %></small></p>
                            
                            <h4 class="fw-bold text-center text-light mt-3">
                                R$ <%= jogo.preco.toFixed(2).replace('.', ',') %>
                            </h4>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-success w-100 py-2">
                            <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
                        </button>
                    </div>
                </div>
            </div>
        </div>
    <% } %>
</div>

<%- include('rodape.ejs') %>